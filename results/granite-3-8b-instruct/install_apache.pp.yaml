
```yaml
---
- name: Ensure Apache is installed and running
  hosts: all
  vars:
    disable: "false"
    apacheconf: "default"

  tasks:
    - name: Check if Apache should be installed
      set_fact:
        installed: "present"
        enable: true
        ensure: "running"
      when: disable != "true"

    - name: Check if Apache should be stopped
      set_fact:
        installed: "absent"
        enable: false
        ensure: "stopped"
      when: disable == "true"

    - name: Install Apache on CentOS/RedHat
      package:
        name: httpd
        state: "{{ installed }}"
      when:
        - ansible_os_family == "RedHat"
        - installed == "present"

    - name: Configure Apache service
      service:
        name: httpd
        state: "{{ ensure }}"
        enabled: "{{ enable }}"
      when:
        - ansible_os_family == "RedHat"

    - name: Copy Apache configuration file
      copy:
        dest: /etc/httpd/conf/httpd.conf
        owner: root
        group: root
        mode: 0644
        backup: yes
      when:
        - ansible_os_family == "RedHat"
        - apacheconf == "default"
```